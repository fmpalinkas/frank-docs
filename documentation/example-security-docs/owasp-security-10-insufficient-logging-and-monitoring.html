<!DOCTYPE html>
<html lang="en">
<head>
  <title>Web Security and Privacy Reference: OWASP 10. Insufficient Logging &amp; Monitoring</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
  <meta http-equiv="content-type" charset="UTF-8">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans" as="font" type="font/ttf" media="screen and print" crossorigin>
  <link rel="preload" href="bin/images/masthead.png" as="image">
  <link rel="preload" href="bin/images/footer.png" as="image">
  <link rel="preload" href="bin/tipuesearch/img/search.png" as="image">
  <link href="bin/styles/screen.css" media="screen" rel="stylesheet" type="text/css">
  <link href="bin/styles/print.css" media="print" rel="stylesheet" type="text/css">
  <link href="bin/styles/prism.css" rel="stylesheet" type="text/css">
  <link href="bin/tipuesearch/tipuesearch.css" rel="stylesheet">
  <meta name="author" content="Frank M. Palinkas, Senior Technical Writer">
</head>
<body class="owasp-security-10-insufficient-logging-and-monitoring">

  <div class="wrapper">

    <ul id="sidenav"></ul>

    <div id="content">

      <div id="innermast"></div>

      <details class="audio" tabindex="0">
        <summary class="return">Listen to this page: <img class="audio-icon" src="bin/images/audio.png" alt="audio icon" /></summary>
        <div data-title="Click &#9654; to listen, &#10074;&#10074; to pause/stop.">
          <audio controls="controls" tabindex="0">
            <source src="bin/voice/10-insufficient-logging-and-monitoring.mp3" type="audio/mpeg" />
            Your browser does not support the
            <code>audio</code> element.
          </audio>
        </div>
      </details>

      <h2 tabindex="0" id="headline">OWASP Top 10 Web App Security Risks - 2017</h2>

      <p class="less">OWASP is the acronym for the <a href="https://www.owasp.org/index.php/Main_Page" target="_blank">Open Web Application Security Project <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>.</p>

      <h3 class="brown3" tabindex="0">10. Insufficient Logging &amp; Monitoring</h3>

      <section class="api">

        <dl>
          <dt tabindex="0">Risk Description</dt>
          <dd>
            <p>Insufficient logging and monitoring, coupled with missing or ineffective integration with incident response allows attackers to:</p>
            <ul>
              <li><p>Further attack systems.</p></li>
              <li><p>Maintain persistence.</p></li>
              <li><p>Pivot to more systems</p></li>
              <li><p>Tamper, extract, or destroy data.</p></li>
            </ul>
            <p>Most breach studies show time to detect a breach is over 200 days, typically detected by external parties rather than internal processes or monitoring.</p>
          </dd>

          <dt tabindex="0">Attack Vectors</dt>
          <dd>
            <p>
              Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.
            </p>
          </dd>

          <dt tabindex="0">Security Weakness</dt>
          <dd>
            <p>
              This issue is included in the Top 10 based on an industry survey.
            </p>
            <ul>
              <li><p>One strategy for determining if you have sufficient monitoring is to examine the logs following penetration testing.</p></li>
              <li><p>The testers' actions should be recorded sufficiently to understand what damages they may have inflicted.</p></li>
            </ul>
          </dd>

          <dt tabindex="0">Impacts</dt>
          <dd>
            <p>
              Most successful attacks start with vulnerability probing.
            </p>
            <ul>
              <li><p>Allowing such probes to continue can raise the likelihood of successful exploit to nearly 100%.</p></li>
              <li><p>In 2016, identifying a breach took an average of 191 days – plenty of time for damage to be inflicted.</p></li>
            </ul>
          </dd>

          <dt tabindex="0">Vulnerability</dt>
          <dd>
            <p>Insufficient logging, detection, monitoring and active response occurs any time:</p>
            <ol>
              <li><p>Auditable events, such as logins, failed logins, and high-value transactions are not logged.</p></li>
              <li><p>Warnings and errors generate no, inadequate, or unclear log messages.</p></li>
              <li><p>Logs of applications and APIs are not monitored for suspicious activity.</p></li>
              <li><p>Logs are only stored locally.</p></li>
              <li><p>Appropriate alerting thresholds and response escalation processes are not in place or effective.</p></li>
              <li><p>Penetration testing and scans by <a href="https://www.owasp.org/index.php/Category:Vulnerability_Scanning_Tools" target="_blank">DAST tools <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> (such as <a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project" target="_blank">OWASP ZAP <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>) do not trigger alerts.</p></li>
              <li><p>The application is unable to detect, escalate, or alert for active attacks in real time or near real time.</p></li>
            </ol>
            <p>You are vulnerable to information leakage if you make logging and alerting events visible to a user or an attacker.</p>
          </dd>

          <dt tabindex="0">Prevention</dt>
          <dd>
            <p>As per the risk of the data stored or processed by the application:</p>
            <ol>
              <li><p>Ensure all login, access control failures, and server-side input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts, and held for sufficient time to allow delayed forensic analysis.</p></li>
              <li><p>Ensure that logs are generated in a format that can be easily consumed by a centralized log management solutions.</p></li>
              <li><p>Ensure high-value transactions have an audit trail with integrity controls to prevent tampering or deletion, such as append-only database tables or similar.</p></li>
              <li><p>Establish effective monitoring and alerting such that suspicious activities are detected and responded to in a timely fashion.</p></li>
              <li><p>Establish or adopt an incident response and recovery plan, such as <a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final" target="_blank">NIST 800-61 rev 2 <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> or later.</p></li>
            </ol>

            <p>There are commercial and open source application protection frameworks such as <a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project" target="_blank">OWASP AppSensor <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>, web application firewalls such as <a href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project" target="_blank">ModSecurity with the OWASP ModSecurity Core Rule Set <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>, and log correlation software with custom dashboards and alerting.</p>
          </dd>

          <dt tabindex="0">Example Attack Scenarios</dt>
          <dd>
            <p><strong>Scenario 1:</strong> An open source project forum software run by a small team was hacked using a flaw in its software. The attackers managed to wipe out the internal source code repository containing the next version, and all of the forum contents. Although source could be recovered, the lack of monitoring, logging or alerting led to a far worse breach. The forum software project is no longer active as a result of this issue.</p>

            <p><strong>Scenario 2:</strong> An attacker uses scans for users using a common password. They can take over all accounts using this password. For all other users, this scan leaves only one false login behind. After some days, this may be repeated with a different password.</p>
            <p><strong>Scenario 3:</strong> A major US retailer reportedly had an internal malware analysis sandbox analyzing attachments. The sandbox software had detected potentially unwanted software, but no one responded to this detection. The sandbox had been producing warnings for some time before the breach was detected due to fraudulent card transactions by an external bank.</p>
          </dd>
        </dl>

        <dl>

          <dt tabindex="0">OWASP References</dt>
          <dd>
            <ul>
              <li><p><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#8:_Implement_Logging_and_Intrusion_Detection" target="_blank">OWASP Proactive Controls: Implement Logging and Intrusion Detection <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab.3DHome" target="_blank">OWASP Application Security Verification Standard: V8 Logging and Monitoring <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab.3DHome" target="_blank">OWASP Testing Guide: Testing for Detailed Error Code <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Logging_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Logging <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
            </ul>
          </dd>

          <dt tabindex="0">Related References</dt>
          <dd>
            <ul>
              <li><p><a href="https://cwe.mitre.org/data/definitions/223.html" target="_blank">CWE-223 (Common Weakness Enumeration): Omission of Security-relevant Information <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://cwe.mitre.org/data/definitions/778.html" target="_blank">CWE-778 (Common Weakness Enumeration): Insufficient Logging <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
            </ul>
          </dd>
        </dl>
      </section>

      <p class="top"><a href="#top" class="return">&#9650; Top</a></p>

      <div id="footer" class="footer"></div>
    </div>
  </div>

  <script src="bin/scripts/global.js"></script>
  <script src="bin/scripts/prism.js"></script>
</body>
</html>