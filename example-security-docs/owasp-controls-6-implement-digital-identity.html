<!DOCTYPE html>
<html lang="en">
<head>
  <title>Web Security and Privacy Reference: Proactive Control 6. Implement Digital Identity</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
  <meta http-equiv="content-type" charset="UTF-8">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans" as="font" type="font/ttf" media="screen and print" crossorigin>
  <link rel="preload" href="bin/images/masthead.png" as="image">
  <link rel="preload" href="bin/images/footer.png" as="image">
  <link rel="preload" href="bin/tipuesearch/img/search.png" as="image">
  <link href="bin/styles/screen.css" media="screen" rel="stylesheet" type="text/css">
  <link href="bin/styles/print.css" media="print" rel="stylesheet" type="text/css">
  <link href="bin/styles/prism.css" rel="stylesheet" type="text/css">
  <link href="bin/tipuesearch/tipuesearch.css" rel="stylesheet">
  <meta name="author" content="Frank M. Palinkas, Senior Technical Writer">
</head>
<body class="owasp-controls-6-implement-digital-identity">

  <div class="wrapper">

    <ul id="sidenav"></ul>

    <div id="content">

      <div id="innermast"></div>

      <details class="audio" tabindex="0">
        <summary class="return">Listen to this page: <img class="audio-icon" src="bin/images/audio.png" alt="audio icon" /></summary>
        <div data-title="Click &#9654; to listen, &#10074;&#10074; to pause/stop.">
          <audio controls="controls" tabindex="0">
            <source src="bin/voice/6-implement-digital.mp3" type="audio/mpeg" />
            Your browser does not support the
            <code>audio</code> element.
          </audio>
        </div>
      </details>

      <h2 id="headline" tabindex="0">OWASP Top 10 Proactive Security Controls v3.0</h2>

      <p class="less">OWASP is the acronym for the <a href="https://www.owasp.org/index.php/Main_Page" target="_blank">Open Web Application Security Project <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>.</p>

      <h3 class="brown3" tabindex="0">6. Implement Digital Identity</h3>

      <section class="api">

        <dl>
          <dt tabindex="0">Control Description</dt>
          <dd>
            <p>
              Digital Identity is the unique representation of a user (or other subject) as they engage in an
              online transaction.
            </p>
            <ul>
              <li>
                <p>
                  Authentication is the process of verifying that an individual or entity is who they
                  claim to be.
                </p>
              </li>
              <li>
                <p>
                  Session management is a process by which a server maintains the state of the
                  users authentication so that the user may continue to use the system without reauthenticating.
                </p>
              </li>
              <li>
                <p>
                  The NIST Special Publication 800-63B: Digital Identity Guidelines (Authentication and
                  Lifecycle Management provides solid guidance on implementing digital identity, authentication and
                  session management controls.
                </p>
              </li>
            </ul>

            <p>Some recommendations follow below for secure implementation.</p>
          </dd>

          <dt tabindex="0">Authentication Levels</dt>
          <dd>
            <p>
              NIST 800-63b describes three levels of a authentication assurance called a authentication
              assurance level (AAL).
            </p>
            <ul>
              <li>
                <p>
                  AAL level 1 is reserved for lower-risk applications that do not contain PII
                  or other private data.
                </p>
              </li>
              <li>
                <p>
                  At AAL level 1, only single-factor authentication is required, typically
                  through the use of a password.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Level 1: Passwords</dt>
          <dd>
            <p>
              Passwords are really, really important. We need policy, we need to store them securely, we
              need to sometimes allow users to reset them.
            </p>
          </dd>
          <dd>
            <b>Password Requirements</b>
            <p>Passwords should comply with the following requirements at the very least:</p>
            <ul>
              <li>
                <p>
                  Be at least 8 characters in length if multi-factor authentication (MFA) and other
                  controls are also used. If MFA is not possible, this should be increased to at least 10
                  characters
                </p>
              </li>
              <li>
                <p>
                  All printing ASCII characters as well as the space character should be acceptable in
                  memorized secrets
                </p>
              </li>
              <li><p>Encourage the use of long passwords and passphrases</p></li>
              <li>
                <p>
                  Remove complexity requirements as these have been found to be of limited
                  effectiveness. Instead, the adoption of MFA or longer password lengths is
                  recommended.
                </p>
              </li>

              <li>
                <p>
                  Ensure that passwords used are not commonly used passwords that have been
                  already been leaked in a previous compromise. You may choose to block the top 1000
                  or 10000 most common passwords which meet the above length requirements and
                  are found in compromised password lists.
                </p>
              </li>
              <li>
                <p>
                  The following link contains the most
                  commonly found passwords: <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords" target="_blank">SecLists <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a>
                </p>
              </li>
            </ul>
            <p><b>Implement Secure Password Recovery Mechanism</b></p>
            <p>
              It is common for an application to have a mechanism for a user to gain access to their account
              in the event they forget their password.
            </p>
            <ul>
              <li>
                <p>
                  A good design workflow for a password recovery
                  feature will use multi-factor authentication elements.
                </p>
              </li>
              <li>
                <p>
                  For example, it may ask a security
                  question - something they know, and then send a generated token to a device - something
                  they own.
                </p>
              </li>
              <li>
                <p>
                  Please see the <a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet" target="_blank">Forgot Password Cheat Sheet <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> and
                  <a href="https://www.owasp.org/index.php/Choosing_and_Using_Security_Questions_Cheat_Sheet" target="_blank">Choosing and Using Security Questions Cheat Sheet <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> for further details.
                </p>
              </li>
            </ul>
            <p><b>Implement Secure Password Storage</b></p>
            <p>
              In order to provide strong authentication controls, an application must securely store user
              credentials. Furthermore, cryptographic controls should be in place such that if a credential
              (e.g., a password) is compromised, the attacker does not immediately have access to this
              information.
            </p>
            <p><b>PHP Example for Password Storage</b></p>
            <p>
              The following code is an example for secure password hashing in PHP using password_hash() function
              (available since 5.5.0) which defaults to using the bcrypt algorithm. The example uses a work
              factor of 15.
            </p>
            <pre class="line-numbers"><code class="language-php">&lt;?php
  $cost = 15;
  $password_hash = password_hash("secret_password", PASSWORD_DEFAULT, ["cost" =>
$cost] );
?&gt;
</code></pre>
            <p>Please see the <a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" target="_blank">OWASP Password Storage Cheat Sheet <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> for further details.</p>
          </dd>

          <dt tabindex="0">Level 2: Multi-Factor Authentication</dt>
          <dd>
            <p>
              NIST 800-63b AAL level 2 is reserved for higher-risk applications that contain "self-asserted PII
              or other personal information made available online."
            </p>
            <ul>
              <li>
                <p>
                  At AAL level 2 multi-factor
                  authentication is required including OTP or other forms of multi-factor implementation.
                </p>
              </li>
              <li>
                <p>
                  Multi-factor authentication (MFA) ensures that users are who they claim to be by requiring
                  them to identify themselves with a combination of:
                </p>

                <ul>
                  <li>
                    <p>Something you know – password or PIN</p>
                  </li>
                  <li><p>Something you own – token or phone</p></li>
                  <li><p>Something you are – biometrics, such as a fingerprint</p></li>
                </ul>
              </li>
            </ul>
            <p>
              Using passwords as a sole factor provides weak security. Multi-factor solutions provide a
              more robust solution by requiring an attacker to acquire more than one element to
              authenticate with the service.
            </p>

            <p>
              It is worth noting that biometrics, when employed as a single factor of authentication, are not
              considered acceptable secrets for digital authentication.
            </p>
            <ul>
              <li>
                <p>
                  They can be obtained online or by
                  taking a picture of someone with a camera phone (e.g., facial images) with or without their
                  knowledge, lifted from objects someone touches (e.g., latent fingerprints), or captured with
                  high resolution images (e.g., iris patterns).
                </p>
              </li>
              <li>
                <p>
                  Biometrics must be used only as part of multifactor
                  authentication with a physical authenticator (something you own).
                </p>
              </li>
              <li>
                <p>
                  For example,
                  accessing a multi-factor one-time password (OTP) device that will generate a one-time
                  password that the user manually enters for the verifier.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Level 3: Cryptographic Based Authentication</dt>
          <dd>
            <p>
              NIST 800-63b Authentication Assurance Level 3 (AAL3) is required when the impact of
              compromised systems could lead to personal harm, significant financial loss, harm the public
              interest or involve civil or criminal violations.
            </p>
            <ul>
              <li>
                <p>
                  AAL3 requires authentication that is "based on
                  proof of possession of a key through a cryptographic protocol".
                </p>
              </li>
              <li>
                <p>
                  This type of authentication is
                  used to achieve the strongest level of authentication assurance.
                </p>
              </li>
              <li>
                <p>
                  This is typically done though
                  hardware cryptographic modules.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Session Management</dt>
          <dd>
            <p>
              Once the initial successful user authentication has taken place, an application may choose to
              track and maintain this authentication state for a limited amount of time.
            </p>
            <ul>
              <li>
                <p>
                  This will allow the
                  user to continue using the application without having to keep re-authentication with each
                  request.
                </p>
              </li>
              <li><p>Tracking of this user state is called Session Management.</p></li>
            </ul>
          </dd>

          <dt tabindex="0">Session Generation and Expiration</dt>
          <dd>
            <p>
              User state is tracked in a session.
            </p>
            <ul>
              <li>
                <p>
                  This session is typically stored on the server for traditional
                  web based session management.
                </p>
              </li>
              <li>
                <p>
                  A session identifier is then given to the user so the user can
                  identify which server-side session contains the correct user data.
                </p>
              </li>
              <li>
                <p>
                  The client only needs to
                  maintain this session identifier, which also keeps sensitive server-side session data off of the
                  client.
                </p>
              </li>
            </ul>
            <p>
              Here are a few controls to consider when building or implementing session management
              solutions:
            </p>
            <ul>
              <li><p>Ensure that the session id is long, unique and random.</p></li>
              <li>
                <p>
                  The application should generate a new session or at least rotate the session id during
                  authentication and re-authentication.
                </p>
              </li>
              <li>
                <p>
                  The application should implement an idle timeout after a period of inactivity and an
                  absolute maximum lifetime for each session, after which users must re-authenticate.
                  The length of the timeouts should be inversely proportional with the value of the data
                  protected.
                </p>
              </li>
              <li>
                <p>
                  Please see the <a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet" target="_blank">Session Management Cheat Sheet <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a> for further details. ASVS Section 3 covers
                  additional session management requirements.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Browser Cookies</dt>
          <dd>
            <p>
              Browser cookies are a common method for web application to store session identifiers for
              web applications implementing standard session management techniques. Here are some
              defenses to consider when using browser cookies.
            </p>
            <ul>
              <li>
                <p>
                  When browser cookies are used as the mechanism for tracking the session of an
                  authenticated user, these should be accessible to a minimum set of domains and
                  paths and should be tagged to expire at, or soon after, the session's validity period.
                </p>
              </li>
              <li>
                <p>
                  The ‘secure’ flag should be set to ensure the transfer is done via secure channel only
                  (TLS).
                </p>
              </li>
              <li><p>HttpOnly flag should be set to prevent the cookie from being accessed via JavaScript.</p></li>
              <li>
                <p>
                  Adding "samesite" attributes to cookies prevents some modern browsers from
                  sending cookies with cross-site requests and provides protection against cross-site
                  request forgery and information leakage attacks.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Tokens</dt>
          <dd>
            <p>
              Server-side sessions can be limiting for some forms of authentication.
            </p>
            <ul>
              <li>
                <p>
                  "Stateless services"
                  allow for client side management of session data for performance purposes so they server has
                  less of a burden to store and verify user session.
                </p>
              </li>
              <li>
                <p>
                  These "stateless" applications generate a
                  short-lived access token which can be used to authenticate a client request without sending
                  the user's credentials after the initial authentication.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">JWT (JSON Web Tokens)</dt>
          <dd>
            <p>
              JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and selfcontained
              way for securely transmitting information between parties as a JSON object. This
              information can be verified and trusted because it is digitally signed. A JWT token is created
              during authentication and is verified by the server (or servers) before any processing.
            </p>
            <p>
              However, JWT's are often not saved by the server after initial creation. JWT's are typically
              created and then handed to a client without being saved by the server in any way. The
              integrity of the token is maintained through the use of digital signatures so a server can later
              verify that the JWT is still valid and was not tampered with since its creation.
            </p>
            <p>
              This approach is both stateless and portable in the way that client and server technologies can
              be different yet still interact.
            </p>
          </dd>

          <dt tabindex="0">Caution</dt>
          <dd>
            <p>
              Digital identity, authentication and session management are very big topics.
            </p>
            <ul>
              <li>
                <p>
                  We're scratching
                  the surface of the topic of Digital Identity here.
                </p>
              </li>
              <li>
                <p>
                  Ensure that your most capable engineering
                  talent is responsible for maintaining the complexity involved with most Identity solutions.
                </p>
              </li>
            </ul>
          </dd>

          <dt tabindex="0">Vulnerabilities Prevented</dt>
          <dd>
            <ul>
              <li><p><a href="https://www.owasp.org/index.php?title=Top_10_2017-A2-Broken_Authentication_and_Session_Management&redirect=no" target="_blank">OWASP Top 10 2017 A2- Broken Authentication and Session Management <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Mobile_Top_10_2014-M5" target="_blank">OWASP Mobile Top 10 2014-M5- Poor Authorization and Authentication <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
            </ul>
          </dd>

          <dt tabindex="0">Tools</dt>
          <dd>
            <ul>
              <li><p><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials" target="_blank">Daniel Miessler: Most commonly found passwords <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
            </ul>
          </dd>

          <dt tabindex="0">References</dt>
          <dd>
            <ul>
              <li><p><a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Authentication <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Password Storage <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Forgot Password <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Choosing_and_Using_Security_Questions_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Choosing and Using Security Questions <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: Session Management <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet" target="_blank">OWASP Cheat Sheet: IOS Developer <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://www.owasp.org/index.php/Testing_for_authentication" target="_blank">OWASP Testing Guide: Testing for Authentication <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
              <li><p><a href="https://pages.nist.gov/800-63-3/" target="_blank">NIST Special Publication 800-63 Revision 3 - Digital Identity Guidelines <img src="bin/images/link.png" class="exlink" alt="- This is an external link." /></a></p></li>
            </ul>
          </dd>
        </dl>
      </section>

      <p class="top"><a href="#top" class="return">&#9650; Top</a></p>

      <div id="footer" class="footer"></div>
    </div>
  </div>

  <script src="bin/scripts/global.js"></script>
  <script src="bin/scripts/prism.js"></script>
</body>
</html>